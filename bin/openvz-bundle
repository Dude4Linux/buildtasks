#!/bin/bash -e
# depends: bzip2

fatal() { echo "FATAL [$(basename $0)]: $@" 1>&2; exit 1; }
info() { echo "INFO [$(basename $0)]: $@"; }

usage() {
cat<<EOF
Syntax: $0 rootfs
Bundles rootfs into OpenVZ optimized builds

Arguments::

    rootfs          - root filesystem path

EOF
exit 1
}

if [[ "$#" != "1" ]]; then
    usage
fi

rootfs=$1
name=$(echo $rootfs | sed 's/.rootfs//')

info "creating $name-openvz.tar.gz"
tar -C $rootfs -zcf $name-openvz.tar.gz .

